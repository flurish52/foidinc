import{s as h,B as X,x as F,g as L,o as C,b as t,n as x,G as H,i as J,e as _,F as W,p as Y,j as B,c as ee,w as te,t as E,k as M,m as ae,q as oe,a as K,M as se,H as q,y as G}from"./app-DucrWc5X.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as ne}from"./AuthenticatedLayout-BXctQaKI.js";const le={class:"rich-editor"},ie={class:"toolbar"},re={__name:"RichEditor",props:{modelValue:{type:String,default:""},uploadUrl:{type:String,default:"/upload"}},emits:["update:modelValue"],setup(I,{emit:b}){const y=I,s=b,l=h(null),k=h(null);X(()=>{y.modelValue&&l.value&&(l.value.innerHTML=y.modelValue)}),F(()=>y.modelValue,o=>{l.value&&l.value.innerHTML!==o&&(l.value.innerHTML=o||"")});const g=()=>{l.value&&s("update:modelValue",l.value.innerHTML)},n=(o,e=null)=>{document.execCommand(o,!1,e),l.value.focus(),g()},c=o=>{try{return document.queryCommandState(o)}catch{return!1}},T=o=>{const e=o.target.value;e&&(n("formatBlock",`<${e}>`),o.target.value="")},A=o=>{const e=o.target.value;e&&(n("fontName",e),o.target.value="")},$=o=>{const e=o.target.value;e&&(n("fontSize",e),o.target.value="")},m=o=>{n("foreColor",o.target.value)},r=o=>{n("backColor",o.target.value)},p=()=>{const o=prompt("Enter URL:");o&&n("createLink",o)},f=()=>{n("insertHorizontalRule")},D=()=>{n("removeFormat")},N=()=>{k.value.click()},i=o=>{const e=document.createElement("div");e.className="image-container",e.style.cssText=`
    display: inline-block;
    position: relative;
    max-width: 100%;
    margin: 5px;
    border: 2px dashed transparent;
  `;const a=document.createElement("img");a.src=o,a.style.cssText=`
    max-width: 100%;
    height: auto;
    display: block;
  `;const d=document.createElement("div");d.className="resize-handle",d.style.cssText=`
    position: absolute;
    bottom: -5px;
    right: -5px;
    width: 10px;
    height: 10px;
    background: #007cba;
    cursor: se-resize;
    display: none;
  `,e.appendChild(a),e.appendChild(d),e.addEventListener("mouseenter",()=>{e.style.border="2px dashed #007cba",d.style.display="block"}),e.addEventListener("mouseleave",()=>{e.style.border="2px dashed transparent",d.style.display="none"});let w=!1,S,U,z,P;return d.addEventListener("mousedown",V=>{w=!0,S=V.clientX,U=V.clientY,z=parseInt(document.defaultView.getComputedStyle(a).width,10),P=parseInt(document.defaultView.getComputedStyle(a).height,10),V.preventDefault()}),document.addEventListener("mousemove",V=>{if(!w)return;const j=z+V.clientX-S,O=P+V.clientY-U;j>50&&O>30&&(a.style.width=j+"px",a.style.height=O+"px")}),document.addEventListener("mouseup",()=>{w=!1}),e},u=o=>{const e=window.getSelection(),a=e.getRangeAt(0),d=i(o);a.deleteContents(),a.insertNode(d),a.setStartAfter(d),a.setEndAfter(d),e.removeAllRanges(),e.addRange(a),l.value.focus(),g()},v=async o=>{const e=o.target.files[0];if(e){try{const a=new FormData;a.append("image",e);const d=await fetch(y.uploadUrl,{method:"POST",body:a,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}});if(!d.ok)throw new Error("Upload failed");const w=await d.json();u(w.url)}catch(a){console.error("Image upload failed:",a);const d=new FileReader;d.onload=w=>{u(w.target.result)},d.readAsDataURL(e)}o.target.value=""}},R=async o=>{const a=Array.from(o.clipboardData?.items||[]).find(d=>d.type.startsWith("image/"));if(a){o.preventDefault();const d=a.getAsFile();if(d)try{const w=new FormData;w.append("image",d);const S=await fetch(y.uploadUrl,{method:"POST",body:w,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}});if(!S.ok)throw new Error("Upload failed");const U=await S.json();u(U.url)}catch(w){console.error("Image upload failed:",w);const S=new FileReader;S.onload=U=>{u(U.target.result)},S.readAsDataURL(d)}}},Z=o=>{if(o.ctrlKey||o.metaKey)switch(o.key.toLowerCase()){case"b":o.preventDefault(),n("bold");break;case"i":o.preventDefault(),n("italic");break;case"u":o.preventDefault(),n("underline");break;case"z":o.shiftKey?(o.preventDefault(),n("redo")):(o.preventDefault(),n("undo"));break}};return(o,e)=>(C(),L("div",le,[t("div",ie,[t("button",{onClick:e[0]||(e[0]=a=>n("bold")),class:x({active:c("bold")}),title:"Bold"},[...e[19]||(e[19]=[t("strong",null,"B",-1)])],2),t("button",{onClick:e[1]||(e[1]=a=>n("italic")),class:x({active:c("italic")}),title:"Italic"},[...e[20]||(e[20]=[t("em",null,"I",-1)])],2),t("button",{onClick:e[2]||(e[2]=a=>n("underline")),class:x({active:c("underline")}),title:"Underline"},[...e[21]||(e[21]=[t("u",null,"U",-1)])],2),t("button",{onClick:e[3]||(e[3]=a=>n("strikeThrough")),class:x({active:c("strikeThrough")}),title:"Strikethrough"},[...e[22]||(e[22]=[t("s",null,"S",-1)])],2),e[26]||(e[26]=t("div",{class:"separator"},null,-1)),t("select",{onChange:e[4]||(e[4]=a=>T(a)),class:"format-select"},[...e[23]||(e[23]=[H('<option value="" data-v-8c8c2856>Format</option><option value="p" data-v-8c8c2856>Paragraph</option><option value="h1" data-v-8c8c2856>Heading 1</option><option value="h2" data-v-8c8c2856>Heading 2</option><option value="h3" data-v-8c8c2856>Heading 3</option><option value="h4" data-v-8c8c2856>Heading 4</option><option value="h5" data-v-8c8c2856>Heading 5</option><option value="h6" data-v-8c8c2856>Heading 6</option>',8)])],32),e[27]||(e[27]=t("div",{class:"separator"},null,-1)),t("button",{onClick:e[5]||(e[5]=a=>n("insertOrderedList")),class:x({active:c("insertOrderedList")}),title:"Ordered List"}," OL ",2),t("button",{onClick:e[6]||(e[6]=a=>n("insertUnorderedList")),class:x({active:c("insertUnorderedList")}),title:"Unordered List"}," UL ",2),t("button",{onClick:e[7]||(e[7]=a=>n("indent")),title:"Indent"},"â†’"),t("button",{onClick:e[8]||(e[8]=a=>n("outdent")),title:"Outdent"},"â†"),e[28]||(e[28]=t("div",{class:"separator"},null,-1)),t("button",{onClick:e[9]||(e[9]=a=>n("justifyLeft")),class:x({active:c("justifyLeft")}),title:"Align Left"}," â«· ",2),t("button",{onClick:e[10]||(e[10]=a=>n("justifyCenter")),class:x({active:c("justifyCenter")}),title:"Center"}," â‰¡ ",2),t("button",{onClick:e[11]||(e[11]=a=>n("justifyRight")),class:x({active:c("justifyRight")}),title:"Align Right"}," â«¸ ",2),t("button",{onClick:e[12]||(e[12]=a=>n("justifyFull")),class:x({active:c("justifyFull")}),title:"Justify"}," â–¦ ",2),e[29]||(e[29]=t("div",{class:"separator"},null,-1)),t("select",{onChange:e[13]||(e[13]=a=>A(a)),class:"font-select"},[...e[24]||(e[24]=[H('<option value="" data-v-8c8c2856>Font</option><option value="Arial" data-v-8c8c2856>Arial</option><option value="Helvetica" data-v-8c8c2856>Helvetica</option><option value="Times New Roman" data-v-8c8c2856>Times New Roman</option><option value="Georgia" data-v-8c8c2856>Georgia</option><option value="Courier New" data-v-8c8c2856>Courier New</option><option value="Verdana" data-v-8c8c2856>Verdana</option>',7)])],32),t("select",{onChange:e[14]||(e[14]=a=>$(a)),class:"size-select"},[...e[25]||(e[25]=[H('<option value="" data-v-8c8c2856>Size</option><option value="1" data-v-8c8c2856>8pt</option><option value="2" data-v-8c8c2856>10pt</option><option value="3" data-v-8c8c2856>12pt</option><option value="4" data-v-8c8c2856>14pt</option><option value="5" data-v-8c8c2856>18pt</option><option value="6" data-v-8c8c2856>24pt</option><option value="7" data-v-8c8c2856>36pt</option>',8)])],32),t("input",{type:"color",onChange:e[15]||(e[15]=a=>m(a)),title:"Text Color",class:"color-input"},null,32),t("input",{type:"color",onChange:e[16]||(e[16]=a=>r(a)),title:"Background Color",class:"color-input"},null,32),e[30]||(e[30]=t("div",{class:"separator"},null,-1)),t("button",{onClick:p,title:"Insert Link"},"ðŸ”—"),t("button",{onClick:f,title:"Horizontal Line"},"â€•"),t("input",{type:"file",onChange:v,accept:"image/*",ref_key:"imageInput",ref:k,style:{display:"none"}},null,544),t("button",{onClick:N,title:"Insert Image"},"ðŸ“·"),e[31]||(e[31]=t("div",{class:"separator"},null,-1)),t("button",{onClick:e[17]||(e[17]=a=>n("undo")),title:"Undo"},"â†¶"),t("button",{onClick:e[18]||(e[18]=a=>n("redo")),title:"Redo"},"â†·"),t("button",{onClick:D,title:"Clear Formatting"},"ðŸ§¹")]),t("div",{ref_key:"editor",ref:l,class:"editor-content",contenteditable:"true",dir:"ltr",onInput:g,onPaste:R,onKeydown:Z},null,544)]))}},de=Q(re,[["__scopeId","data-v-8c8c2856"]]),ue={class:"space-y-4"},ce={key:0,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4"},pe=["src"],ve=["onClick"],ge={__name:"SlidersEditor",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(I,{emit:b}){const y=I,s=b,l=h([...y.modelValue]),k=h(null),g=h(!1),n=()=>k.value.click(),c=m=>{Array.from(m.target.files).forEach(p=>{const f=new FileReader;f.onload=()=>{l.value.push({file:p,preview:f.result}),$()},f.readAsDataURL(p)})},T=m=>{g.value=!1,Array.from(m.dataTransfer.files).forEach(p=>{if(!p.type.startsWith("image/"))return;const f=new FileReader;f.onload=()=>{l.value.push({file:p,preview:f.result}),$()},f.readAsDataURL(p)})},A=m=>{l.value.splice(m,1),$()},$=()=>{const m=l.value.map(r=>r.file||r);s("update:modelValue",m)};return F(()=>y.modelValue,m=>{l.value=m.map(r=>r instanceof File?{file:r,preview:URL.createObjectURL(r)}:r)},{deep:!0}),(m,r)=>(C(),L("div",ue,[r[3]||(r[3]=t("h1",{class:"text-2xl font-bold text-gray-800 mb-4"},"Slider Editor",-1)),t("div",{onClick:n,onDragover:r[0]||(r[0]=_(p=>g.value=!0,["prevent"])),onDragleave:r[1]||(r[1]=p=>g.value=!1),onDrop:_(T,["prevent"]),class:x([{"border-blue-500 bg-blue-50":g.value,"border-gray-300":!g.value},"border-2 border-dashed rounded-xl p-8 text-center cursor-pointer transition-colors"])},[t("input",{type:"file",ref_key:"fileInput",ref:k,onChange:c,multiple:"",accept:"image/*",class:"hidden"},null,544),r[2]||(r[2]=t("div",{class:"flex flex-col items-center justify-center space-y-2"},[t("p",{class:"text-gray-700 font-medium"},"Drag & drop images here or click to browse"),t("p",{class:"text-sm text-gray-500"},"Recommended size: 800x800px (JPEG, PNG)")],-1))],34),l.value.length?(C(),L("div",ce,[(C(!0),L(W,null,Y(l.value,(p,f)=>(C(),L("div",{key:f,class:"relative group rounded-lg overflow-hidden border border-gray-300"},[t("img",{src:p.preview||`/storage/${p}`,class:"w-full h-40 object-cover"},null,8,pe),t("button",{onClick:D=>A(f),class:"absolute top-1 right-1 bg-red-500 text-white p-1 rounded-full hover:bg-red-600"}," âœ• ",8,ve)]))),128))])):J("",!0)]))}},me={class:"min-h-screen bg-gray-50"},fe={class:"bg-white border-b border-gray-200 sticky top-0 z-10"},be={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8"},ye={class:"flex items-center justify-between h-16"},xe={class:"flex items-center space-x-4"},he={class:"text-lg font-semibold text-gray-900"},we={class:"flex items-center space-x-2"},ke={class:"text-sm text-gray-500"},Ce={class:"flex items-center space-x-3"},Se=["disabled"],Le=["disabled"],$e={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Ee={key:0,class:"space-y-6"},De={class:"flex items-center justify-around space-x-4 text-sm text-gray-500 pb-4 border-b border-gray-200"},Re={class:"flex items-center space-x-2"},Ue={class:"flex items-center space-x-2"},Ve={class:"capitalize"},Ie={class:"mt-4"},Te=["value"],Ae={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},Fe={__name:"PageEditor",props:{page:Object},setup(I){const b=I,y=h(!!b.page),s=h({id:b.page?.id||null,parent_id:b.page?.parent_id||null,title:b.page?.title||"",slug:b.page?.slug||"",thumbnail:b.page?.thumbnail||null,sliders:b.page?.sliders||"[]",status:b.page?.status||"draft",content:b.page?.content||""}),l=h([]);try{l.value=s.value.sliders?JSON.parse(s.value.sliders):[]}catch{l.value=[]}const k=h(s.value.content||""),g=h(null),n=()=>{se(()=>{g.value&&(g.value.style.height="auto",g.value.style.height=g.value.scrollHeight+"px")})};F(()=>s.value.title,n),B(()=>{const i=k.value.replace(/<[^>]*>/g,"").trim();return i?i.split(/\s+/).length:0});const c=h("saved"),T=B(()=>{switch(c.value){case"saving":return"Saving...";case"saved":return"All changes saved";case"error":return"Error saving";default:return"Not saved"}}),A=i=>new Date(i).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),$=h(!1);F(l,i=>{s.value.sliders=JSON.stringify(i||[])},{deep:!0});const m=async()=>{await f()},r=async()=>{if(!s.value.title||!k.value){alert("Title and content are required");return}if(s.value.status="published",!(await q.patch(`/admin/update_status/${s.value.slug}`,{status:s.value.status}))?.data)throw new Error("No response data received");G.visit(`/admin/edit_page/${s.value.slug}`)},p=h(!1),f=async()=>{p.value=!0,c.value="saving";try{const i=new FormData;i.append("title",s.value.title||""),i.append("content",s.value.content||""),i.append("status",s.value.status||"draft"),i.append("thumbnail",s.value.thumbnail||""),i.append("parent_id",s.value.parent_id||null),Array.isArray(l.value)&&l.value.forEach(R=>{R&&(typeof R=="string"?i.append("sliders_existing[]",R):i.append("sliders_new[]",R))}),y.value&&i.append("_method","PATCH");const u=y.value?`/admin/edit_page/${s.value.id}`:"/admin/store_page",v=await q.post(u,i);if(!v?.data)throw new Error("No response data received");G.visit(`/admin/edit_page/${v.data.data.slug}`),y.value=!0,c.value="saved",s.value.status==="published"&&alert("Page published successfully!")}catch(i){console.error("Save failed:",i),c.value="error",alert("Failed to save: "+(i.response?.data?.message||i.message))}finally{p.value=!1}};let D;const N=()=>{F([()=>s.value.title,k],()=>{D&&clearTimeout(D),c.value="unsaved",D=setTimeout(()=>{s.value.title&&k.value&&m()},2e3)})};return X(()=>{n(),N()}),(i,u)=>(C(),ee(ne,null,{default:te(()=>[t("div",me,[t("div",fe,[t("div",be,[t("div",ye,[t("div",xe,[t("h1",he,E(y.value?"Edit Page":"New Page"),1),t("div",we,[t("div",{class:x(["w-2 h-2 rounded-full",c.value==="saved"?"bg-green-400":c.value==="saving"?"bg-yellow-400":"bg-gray-300"])},null,2),t("span",ke,E(T.value),1)])]),t("div",Ce,[t("button",{onClick:m,disabled:p.value,class:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50"},E(p.value?"Saving...":"Save"),9,Se),t("button",{onClick:r,disabled:p.value||!s.value.title||!k.value,class:"px-4 py-1.5 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"},E(s.value.status==="published"?"Update":"Publish"),9,Le)])])])]),t("div",$e,[$.value?J("",!0):(C(),L("div",Ee,[t("div",null,[M(t("textarea",{"onUpdate:modelValue":u[0]||(u[0]=v=>s.value.title=v),placeholder:"Page title...",class:"w-full text-4xl font-bold text-gray-900 placeholder-gray-400 border-none resize-none overflow-hidden bg-transparent focus:outline-none focus:ring-0",rows:"1",ref_key:"titleInput",ref:g,onInput:n},null,544),[[ae,s.value.title]])]),t("div",De,[t("div",Re,[u[4]||(u[4]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),t("span",null,E(A(s.value.updated_at||new Date)),1)]),t("div",Ue,[t("div",{class:x(["w-2 h-2 rounded-full",s.value.status==="published"?"bg-green-500":"bg-yellow-500"])},null,2),t("span",Ve,E(s.value.status||"draft"),1)]),t("div",Ie,[u[6]||(u[6]=t("label",{for:"parent",class:"block text-sm font-medium text-gray-700"},"Parent Page",-1)),M(t("select",{id:"parent","onUpdate:modelValue":u[1]||(u[1]=v=>s.value.parent_id=v),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[u[5]||(u[5]=t("option",{value:""},"None",-1)),(C(!0),L(W,null,Y(i.$page.props.links,v=>(C(),L("option",{key:v.id,value:v.id},E(v.title),9,Te))),128))],512),[[oe,s.value.parent_id]])])]),t("div",Ae,[K(de,{modelValue:s.value.content,"onUpdate:modelValue":u[2]||(u[2]=v=>s.value.content=v),"upload-url":"/api/upload-image",class:"min-h-[600px]"},null,8,["modelValue"])]),t("div",null,[K(ge,{modelValue:l.value,"onUpdate:modelValue":u[3]||(u[3]=v=>l.value=v)},null,8,["modelValue"])])]))])])]),_:1}))}},Pe=Q(Fe,[["__scopeId","data-v-41eb05e8"]]);export{Pe as default};
